- id: "921110"
  name: HTTP Request Smuggling Attack
  variable: ARGS_NAMES|ARGS|REQUEST_BODY|XML:/*
  regex: (?:get|post|head|options|connect|put|delete|trace|track|patch|propfind|propatch|mkcol|copy|move|lock|unlock)\s+[^\s]+\s+http/\d
  phase: 2
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
    - htmlEntityDecode
    - lowercase
  tags:
    - application-multi
    - language-multi
    - platform-multi
    - attack-protocol
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/PROTOCOL-ATTACK
    - capec/1000/210/272/220/33
- id: "921120"
  name: HTTP Response Splitting Attack
  variable: REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/*
  regex: '[\r\n]\W*?(?:content-(?:type|length)|set-cookie|location):\s*\w'
  phase: 2
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
    - lowercase
  tags:
    - application-multi
    - language-multi
    - platform-multi
    - attack-protocol
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/PROTOCOL-ATTACK
    - capec/1000/210/272/220/34
- id: "921130"
  name: HTTP Response Splitting Attack
  variable: REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/*
  regex: (?:\bhttp/\d|<(?:html|meta)\b)
  phase: 2
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
    - htmlEntityDecode
    - lowercase
  tags:
    - application-multi
    - language-multi
    - platform-multi
    - attack-protocol
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/PROTOCOL-ATTACK
    - capec/1000/210/272/220/34
- id: "921140"
  name: HTTP Header Injection Attack via headers
  variable: REQUEST_HEADERS_NAMES|REQUEST_HEADERS
  regex: '[\n\r]'
  phase: 1
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
    - urlDecodeUni
  tags:
    - application-multi
    - language-multi
    - platform-multi
    - attack-protocol
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/PROTOCOL-ATTACK
    - capec/1000/210/272/220/273
- id: "921150"
  name: HTTP Header Injection Attack via payload (CR/LF detected)
  variable: ARGS_NAMES
  regex: '[\n\r]'
  phase: 2
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
  tags:
    - application-multi
    - language-multi
    - platform-multi
    - attack-protocol
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/PROTOCOL-ATTACK
    - capec/1000/210/272/220/33
- id: "921160"
  name: HTTP Header Injection Attack via payload (CR/LF and header-name detected)
  variable: ARGS_GET_NAMES|ARGS_GET
  regex: '[\n\r]+(?:\s|location|refresh|(?:set-)?cookie|(?:x-)?(?:forwarded-(?:for|host|server)|host|via|remote-ip|remote-addr|originating-IP))\s*:'
  phase: 1
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
    - lowercase
  tags:
    - application-multi
    - language-multi
    - platform-multi
    - attack-protocol
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/PROTOCOL-ATTACK
    - capec/1000/210/272/220/33
- id: "921190"
  name: HTTP Splitting (CR/LF in request filename detected)
  variable: REQUEST_FILENAME
  regex: '[\n\r]'
  phase: 1
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
    - urlDecodeUni
  tags:
    - application-multi
    - language-multi
    - platform-multi
    - attack-protocol
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/PROTOCOL-ATTACK
    - capec/1000/210/272/220/34
- id: "921200"
  name: LDAP Injection Attack
  variable: REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/*
  regex: ^[^:\(\)\&\|\!\<\>\~]*\)\s*(?:\((?:[^,\(\)\=\&\|\!\<\>\~]+[><~]?=|\s*[&!|]\s*(?:\)|\()?\s*)|\)\s*\(\s*[\&\|\!]\s*|[&!|]\s*\([^\(\)\=\&\|\!\<\>\~]+[><~]?=[^:\(\)\&\|\!\<\>\~]*)
  phase: 2
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
    - htmlEntityDecode
  tags:
    - application-multi
    - language-ldap
    - platform-multi
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/PROTOCOL-ATTACK
    - capec/1000/152/248/136
- id: "921421"
  name: 'Content-Type header: Dangerous content type outside the mime type declaration'
  variable: REQUEST_HEADERS:Content-Type
  regex: ^[^\s\x0b,;]+[\s\x0b,;].*?(?:application/(?:.+\+)?json|(?:application/(?:soap\+)?|text/)xml)
  phase: 1
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
    - lowercase
  tags:
    - application-multi
    - language-multi
    - platform-multi
    - attack-protocol
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/PROTOCOL-ATTACK
    - capec/1000/255/153
- id: "921240"
  name: mod_proxy attack attempt detected
  variable: REQUEST_URI_RAW
  regex: unix:[^|]*\|
  phase: 1
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
    - urlDecodeUni
    - lowercase
  tags:
    - application-multi
    - language-multi
    - platform-apache
    - attack-protocol
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/PROTOCOL-ATTACK
    - capec/1000/210/272/220/33
- id: "921250"
  name: Old Cookies V1 usage attempt detected
  variable: REQUEST_COOKIES:/\x22?\x24Version/
  regex: ^1$
  phase: 1
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
    - lowercase
  tags:
    - application-multi
    - language-multi
    - attack-protocol
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/PROTOCOL-ATTACK
    - capec/1000/210/272/220/33
- id: "921151"
  name: HTTP Header Injection Attack via payload (CR/LF detected)
  variable: ARGS_GET
  regex: '[\n\r]'
  phase: 1
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
  tags:
    - application-multi
    - language-multi
    - platform-multi
    - attack-protocol
    - paranoia-level/2
    - OWASP_CRS
    - OWASP_CRS/PROTOCOL-ATTACK
    - capec/1000/210/272/220/33
- id: "921422"
  name: 'Content-Type header: Dangerous content type outside the mime type declaration'
  variable: REQUEST_HEADERS:Content-Type
  regex: ^[^\s\x0b,;]+[\s\x0b,;].*?\b(?:((?:tex|multipar)t|application)|((?:audi|vide)o|image|cs[sv]|(?:vn|relate)d|p(?:df|lain)|json|(?:soa|cs)p|x(?:ml|-www-form-urlencoded)|form-data|x-amf|(?:octe|repor)t|stream)|([\+/]))\b
  phase: 1
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
    - lowercase
  tags:
    - application-multi
    - language-multi
    - platform-multi
    - attack-protocol
    - paranoia-level/2
    - OWASP_CRS
    - OWASP_CRS/PROTOCOL-ATTACK
    - capec/1000/255/153
# - id: "921170"
#   name: Detect duplicated parameter names (count occurrences)
#   variable: ARGS_NAMES
#   regex: .*
#   phase: 2
#   severity: "NOTICE"
#   block: false
#   transforms:
#     - none
#   tags:
#     - application-multi
#     - language-multi
#     - platform-multi
#     - attack-protocol
#     - OWASP_CRS
#     - OWASP_CRS/PROTOCOL-ATTACK

- id: "921210"
  name: HTTP Parameter Pollution after detecting bogus char after parameter array
  variable: ARGS_NAMES
  regex: (][^\]]+$|][^\]]+\[)
  phase: 2
  severity: '''CRITICAL'''
  block: false
  tags:
    - application-multi
    - language-multi
    - platform-multi
    - attack-protocol
    - paranoia-level/3
    - OWASP_CRS
    - OWASP_CRS/PROTOCOL-ATTACK
    - capec/1000/152/137/15/460
- id: "921220"
  name: HTTP Parameter Pollution possible via array notation
  variable: ARGS_NAMES
  regex: \[
  phase: 2
  severity: '''CRITICAL'''
  block: false
  tags:
    - application-multi
    - language-multi
    - platform-multi
    - attack-protocol
    - paranoia-level/4
    - OWASP_CRS
    - OWASP_CRS/PROTOCOL-ATTACK
    - capec/1000/152/137/15/460
