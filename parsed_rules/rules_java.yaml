- id: "944100"
  name: 'Remote Command Execution: Suspicious Java class detected'
  variable: ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@*
  regex: java\.lang\.(?:runtime|processbuilder)
  phase: 2
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
    - lowercase
  tags:
    - application-multi
    - language-java
    - platform-multi
    - attack-rce
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/ATTACK-JAVA
    - capec/1000/152/137/6
- id: "944110"
  name: 'Remote Command Execution: Java process spawn (CVE-2017-9805)'
  variable: ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@*
  regex: (?:runtime|processbuilder)
  phase: 2
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
    - lowercase
  tags:
    - application-multi
    - language-java
    - platform-multi
    - attack-rce
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/ATTACK-JAVA
    - capec/1000/152/248
  chain:
    - id: ""
      name: ""
      variable: MATCHED_VARS|XML:/*|XML://@*
      regex: (?i)(?:unmarshaller|base64data|java\.)
      phase: 0
      severity: ""
      block: false
- id: "944120"
  name: 'Remote Command Execution: Java serialization (CVE-2015-4852)'
  variable: ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@*
  regex: (?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)
  phase: 2
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
    - lowercase
  tags:
    - application-multi
    - language-java
    - platform-multi
    - attack-rce
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/ATTACK-JAVA
    - capec/1000/152/248
  chain:
    - id: ""
      name: ""
      variable: MATCHED_VARS
      regex: (?:runtime|processbuilder)
      phase: 0
      severity: ""
      block: false
- id: "944130"
  name: Suspicious Java class detected
  variable: ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_FILENAME|REQUEST_HEADERS|XML:/*|XML://@*
  regex: '@pmFromFile java-classes.data'
  phase: 2
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
  tags:
    - application-multi
    - language-java
    - platform-multi
    - attack-rce
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/ATTACK-JAVA
    - capec/1000/152/248
- id: "944140"
  name: 'Java Injection Attack: Java Script File Upload Found'
  variable: FILES|REQUEST_HEADERS:X-Filename|REQUEST_HEADERS:X_Filename|REQUEST_HEADERS:X.Filename|REQUEST_HEADERS:X-File-Name
  regex: .*\.(?:jsp|jspx)\.*$
  phase: 2
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
    - lowercase
  tags:
    - application-multi
    - language-java
    - platform-multi
    - attack-injection-java
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/ATTACK-JAVA
    - capec/1000/152/242
- id: "944150"
  name: 'Potential Remote Command Execution: Log4j / Log4shell'
  variable: REQUEST_LINE|ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS|XML:/*|XML://@*
  regex: (?i)(?:\$|&dollar;?)(?:\{|&l(?:brace|cub);?)(?:[^\}]{0,15}(?:\$|&dollar;?)(?:\{|&l(?:brace|cub);?)|jndi|ctx)
  phase: 2
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
    - urlDecodeUni
    - jsDecode
    - htmlEntityDecode
  tags:
    - application-multi
    - language-java
    - platform-multi
    - attack-rce
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/ATTACK-JAVA
    - capec/1000/152/137/6
- id: "944151"
  name: 'Potential Remote Command Execution: Log4j / Log4shell'
  variable: REQUEST_LINE|ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS|XML:/*|XML://@*
  regex: (?i)(?:\$|&dollar;?)(?:\{|&l(?:brace|cub);?)(?:[^\}]*(?:\$|&dollar;?)(?:\{|&l(?:brace|cub);?)|jndi|ctx)
  phase: 2
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
    - urlDecodeUni
    - jsDecode
    - htmlEntityDecode
  tags:
    - application-multi
    - language-java
    - platform-multi
    - attack-rce
    - paranoia-level/2
    - OWASP_CRS
    - OWASP_CRS/ATTACK-JAVA
    - capec/1000/152/137/6
- id: "944200"
  name: Magic bytes Detected
  variable: ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@*
  regex: \xac\xed\x00\x05
  phase: 2
  severity: '''CRITICAL'''
  block: true
  tags:
    - application-multi
    - language-java
    - platform-multi
    - attack-rce
    - paranoia-level/2
    - OWASP_CRS
    - OWASP_CRS/ATTACK-JAVA
    - capec/1000/152/248
- id: "944210"
  name: Magic bytes Detected Base64 Encoded
  variable: ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@*
  regex: (?:rO0ABQ|KztAAU|Cs7QAF)
  phase: 2
  severity: '''CRITICAL'''
  block: true
  tags:
    - application-multi
    - language-java
    - platform-multi
    - attack-rce
    - paranoia-level/2
    - OWASP_CRS
    - OWASP_CRS/ATTACK-JAVA
    - capec/1000/152/248
- id: "944240"
  name: 'Remote Command Execution: Java serialization (CVE-2015-4852)'
  variable: ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@*
  regex: (?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)
  phase: 2
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
    - lowercase
  tags:
    - application-multi
    - language-java
    - platform-multi
    - attack-rce
    - paranoia-level/2
    - OWASP_CRS
    - OWASP_CRS/ATTACK-JAVA
    - capec/1000/152/248
- id: "944250"
  name: 'Remote Command Execution: Suspicious Java method detected'
  variable: ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@*
  regex: java\b.+(?:runtime|processbuilder)
  phase: 2
  severity: '''CRITICAL'''
  block: true
  transforms:
    - lowercase
  tags:
    - application-multi
    - language-java
    - platform-multi
    - attack-rce
    - paranoia-level/2
    - OWASP_CRS
    - OWASP_CRS/ATTACK-JAVA
    - capec/1000/152/248
- id: "944260"
  name: 'Remote Command Execution: Malicious class-loading payload'
  variable: ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@*
  regex: (?:class\.module\.classLoader\.resources\.context\.parent\.pipeline|springframework\.context\.support\.FileSystemXmlApplicationContext)
  phase: 2
  severity: '''CRITICAL'''
  block: true
  transforms:
    - urlDecodeUni
  tags:
    - application-multi
    - language-java
    - platform-multi
    - attack-rce
    - paranoia-level/2
    - OWASP_CRS
    - OWASP_CRS/ATTACK-JAVA
    - capec/1000/152/248
- id: "944300"
  name: Base64 encoded string matched suspicious keyword
  variable: ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@*
  regex: (?:cnVudGltZQ|HJ1bnRpbWU|BydW50aW1l|cHJvY2Vzc2J1aWxkZXI|HByb2Nlc3NidWlsZGVy|Bwcm9jZXNzYnVpbGRlcg|Y2xvbmV0cmFuc2Zvcm1lcg|GNsb25ldHJhbnNmb3JtZXI|BjbG9uZXRyYW5zZm9ybWVy|Zm9yY2xvc3VyZQ|GZvcmNsb3N1cmU|Bmb3JjbG9zdXJl|aW5zdGFudGlhdGVmYWN0b3J5|Gluc3RhbnRpYXRlZmFjdG9yeQ|BpbnN0YW50aWF0ZWZhY3Rvcnk|aW5zdGFudGlhdGV0cmFuc2Zvcm1lcg|Gluc3RhbnRpYXRldHJhbnNmb3JtZXI|BpbnN0YW50aWF0ZXRyYW5zZm9ybWVy|aW52b2tlcnRyYW5zZm9ybWVy|Gludm9rZXJ0cmFuc2Zvcm1lcg|BpbnZva2VydHJhbnNmb3JtZXI|cHJvdG90eXBlY2xvbmVmYWN0b3J5|HByb3RvdHlwZWNsb25lZmFjdG9yeQ|Bwcm90b3R5cGVjbG9uZWZhY3Rvcnk|cHJvdG90eXBlc2VyaWFsaXphdGlvbmZhY3Rvcnk|HByb3RvdHlwZXNlcmlhbGl6YXRpb25mYWN0b3J5|Bwcm90b3R5cGVzZXJpYWxpemF0aW9uZmFjdG9yeQ|d2hpbGVjbG9zdXJl|HdoaWxlY2xvc3VyZQ|B3aGlsZWNsb3N1cmU)
  phase: 2
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
  tags:
    - application-multi
    - language-java
    - platform-multi
    - attack-rce
    - paranoia-level/3
    - OWASP_CRS
    - OWASP_CRS/ATTACK-JAVA
    - capec/1000/152/248
- id: "944152"
  name: 'Potential Remote Command Execution: Log4j / Log4shell'
  variable: REQUEST_LINE|ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS|XML:/*|XML://@*
  regex: (?i)(?:\$|&dollar;?)(?:\{|&l(?:brace|cub);?)
  phase: 2
  severity: '''CRITICAL'''
  block: true
  transforms:
    - none
    - urlDecodeUni
    - jsDecode
    - htmlEntityDecode
  tags:
    - application-multi
    - language-java
    - platform-multi
    - attack-rce
    - paranoia-level/4
    - OWASP_CRS
    - OWASP_CRS/ATTACK-JAVA
    - capec/1000/152/137/6
