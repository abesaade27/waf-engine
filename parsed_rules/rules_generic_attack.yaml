- id: "934110"
  name: 'Possible Server Side Request Forgery (SSRF) Attack: Cloud provider metadata URL in Parameter'
  variable: REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*
  regex: '@pmFromFile ssrf.data'
  phase: 2
  severity: CRITICAL
  block: true
  transforms:
    - none
  tags:
    - application-multi
    - language-multi
    - platform-multi
    - attack-ssrf
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/ATTACK-GENERIC
    - capec/1000/225/664
- id: "934130"
  name: JavaScript Prototype Pollution
  variable: REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/*
  regex: (?:__proto__|constructor\s*(?:\.|\]?\[)\s*prototype)
  phase: 2
  severity: CRITICAL
  block: true
  transforms:
    - none
    - urlDecodeUni
    - jsDecode
  tags:
    - application-multi
    - language-javascript
    - platform-multi
    - attack-rce
    - attack-injection-generic
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/ATTACK-GENERIC
    - capec/1/180/77
- id: "934150"
  name: Ruby Injection Attack
  variable: REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/*
  regex: Process[\s\x0b]*\.[\s\x0b]*spawn[\s\x0b]*\(
  phase: 2
  severity: CRITICAL
  block: true
  transforms:
    - none
  tags:
    - application-multi
    - language-ruby
    - platform-multi
    - attack-rce
    - attack-injection-generic
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/ATTACK-GENERIC
    - capec/1000/152/242
- id: "934101"
  name: Node.js Injection Attack 2/2 (Safe Version, JSON-safe)
  variable: ARGS_NAMES|ARGS|XML:/*
  # Only match Node.js server APIs, not generic client JS like new Function in POST bodies
  regex: (?i)\b(?:require|child_process|process|fs|spawn|fork)\s*\(
  phase: 2
  severity: CRITICAL
  block: true
  transforms:
    - urlDecodeUni
    - jsDecode
  tags:
    - application-multi
    - language-javascript
    - platform-nodejs
    - attack-rce
    - attack-injection-generic
    - paranoia-level/2
    - OWASP_CRS
    - OWASP_CRS/ATTACK-GENERIC
    - capec/1000/152/242
- id: "934120"
  name: 'Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address'
  variable: REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*
  regex: (?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\.(?:[0-9]{1,3}\.[0-9]{5}|[0-9]{8})|(?:\x5c\x5c[\-0-9a-z]\.?_?)+|\[[0-:a-f]+(?:[\.0-9]+|%[0-9A-Z_a-z]+)?\]|[a-z][\-\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\s\x0b]*&?@(?:(?:[0-9]{1,3}\.){3}[0-9]{1,3}|[a-z][\-\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\.0-9]{0,11}(?:\x{e2}(?:\x91[\xa0-\x{bf}]|\x92[\x80-\x{bf}]|\x93[\x80-\x{a9}\x{ab}-\x{bf}])|\x{e3}\x80\x82)+)
  phase: 2
  severity: CRITICAL
  block: true
  transforms:
    - none
  tags:
    - application-multi
    - language-multi
    - platform-multi
    - attack-ssrf
    - paranoia-level/2
    - OWASP_CRS
    - OWASP_CRS/ATTACK-GENERIC
    - capec/1000/225/664
- id: "934140"
  name: Perl Injection Attack
  variable: REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/*
  regex: ^(?:[^@]|@[^\{])*@+\{[^\}]*\}
  phase: 2
  severity: CRITICAL
  block: true
  transforms:
    - none
  tags:
    - application-multi
    - language-perl
    - platform-multi
    - attack-rce
    - attack-injection-generic
    - paranoia-level/2
    - OWASP_CRS
    - OWASP_CRS/ATTACK-GENERIC
    - capec/1000/152/242
- id: "934180"
  name: SSTI Attack
  variable: REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/*
  regex: (?:{%[^%}]*%}|<%=?[^%>]*%>)
  phase: 2
  severity: CRITICAL
  block: true
  transforms:
    - none
  tags:
    - application-multi
    - platform-multi
    - attack-ssti
    - attack-injection-generic
    - paranoia-level/2
    - OWASP_CRS
    - OWASP_CRS/ATTACK-GENERIC
    - capec/1000/152/242
