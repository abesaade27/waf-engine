- id: "931100"
  name: 'Possible Remote File Inclusion (RFI) Attack: URL Parameter using IP Address'
  variable: ARGS
  regex: ^(?i:file|ftps?|https?)://(?:\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})
  phase: 2
  severity: CRITICAL
  block: true
  transforms:
    - none
  tags:
    - application-multi
    - language-multi
    - platform-multi
    - attack-rfi
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/ATTACK-RFI
    - capec/1000/152/175/253
- id: "931110"
  name: 'Possible Remote File Inclusion (RFI) Attack: Common RFI Vulnerable Parameter Name used w/URL Payload'
  variable: QUERY_STRING|REQUEST_BODY
  regex: (?i)(?:\binclude\s*\([^)]*|mosConfig_absolute_path|_CONF\[path\]|_SERVER\[DOCUMENT_ROOT\]|GALLERY_BASEDIR|path\[docroot\]|appserv_root|config\[root_dir\])=(?:file|ftps?|https?)://
  phase: 2
  severity: CRITICAL
  block: true
  transforms:
    - none
    - urlDecodeUni
  tags:
    - application-multi
    - language-multi
    - platform-multi
    - attack-rfi
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/ATTACK-RFI
    - capec/1000/152/175/253
- id: "931120"
  name: 'Possible Remote File Inclusion (RFI) Attack: URL Payload Used w/Trailing Question Mark Character (?)'
  variable: ARGS
  regex: ^(?i:file|ftps?|https?).*?\?+$
  phase: 2
  severity: CRITICAL
  block: true
  transforms:
    - none
  tags:
    - application-multi
    - language-multi
    - platform-multi
    - attack-rfi
    - paranoia-level/1
    - OWASP_CRS
    - OWASP_CRS/ATTACK-RFI
    - capec/1000/152/175/253
- id: "931130"
  name: 'Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link'
  variable: ARGS
  regex: (?i)(?:(?:url|jar):)?(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://?(?:[^@]+@)?([^/]*)
  phase: 2
  severity: CRITICAL
  block: true
  transforms:
    - none
  tags:
    - application-multi
    - language-multi
    - platform-multi
    - attack-rfi
    - paranoia-level/2
    - OWASP_CRS
    - OWASP_CRS/ATTACK-RFI
    - capec/1000/152/175/253
  chain:
    - id: "931131"
      name: 'Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link'
      variable: REQUEST_FILENAME
      regex: (?i)(?:(?:url|jar):)?(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[^@]+@)?([^/]*)
      phase: 1
      severity: CRITICAL
      block: true
      transforms:
        - none
        - urlDecodeUni
      tags:
        - application-multi
        - language-multi
        - platform-multi
        - attack-rfi
        - paranoia-level/2
        - OWASP_CRS
        - OWASP_CRS/ATTACK-RFI
        - capec/1000/152/175/253
